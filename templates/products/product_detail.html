{% extends "base.html" %} 
{% block title %}Products{% endblock %}
{% block content %}
<div class='col-md-12 mt-3'>
    <div class="card mb-3">
        <div class="row no-gutters">
            <div class="col-md-4">
                <img src="/uploads/{{ product.image }}" class="card-img" alt="{{ product.name }}">
            </div>
            <div class="col-md-8">
                <div class="card-body">
                    <h5 class="card-title">{{ product.name }}</h5>
                    <p class="card-text">{{ product.content }}</p>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="comment mb-4 ml-auto">
  <form @submit.prevent="submitForm">
    <div class="form-group">
      <label for="name">Name</label>
      <input type="text" class="form-control" v-model="name" name="name" id="name" placeholder="Enter your name">
    </div>
    <div class="form-group">
      <label for="comment">Comment</label>
      <textarea class="form-control" v-model="comment" id="comment" name="comment" rows="3" placeholder="Enter your comment"></textarea>
    </div>
    <button type="submit" class="btn btn-primary">Submit</button>
  </form>
  
</div>
<div id="comment" class="mb-5">
  <div class="card mb-3" v-for="comment in listComments">
    <div class="card-body">
      <h5 class="card-title">[[ comment.name ]]</h5>
      <p class="card-text">[[ comment.comment ]]</p>
    </div>
  </div>
</div>
<script>
  new Vue({
    el: '#app',
    data: {
      name: '',
      listComments: '',
      comment: '',
      product_id: '{{ product.id }}',
    },
    delimiters: ['[[', ']]'],  // change delimiters
    created(){
      this.showList()
    },
    methods: {
      submitForm() {
        axios.post(baseUrl + '/api/comments/', {
          name: this.name,
          comment: this.comment,
          product: this.product_id
        })
        .then(response => {
          this.name = '';
          this.comment = '';
          showAlert('success', 'Success!', 'You have commented successfully!');
          this.showList()
        })
        .catch(error => {
          showAlert('error', 'Oops...', 'some errors appears');
        });
      },
      showList() {
        axios.get(baseUrl + '/api/product/comment/' + this.product_id).then(response => {
          this.listComments = response.data
        }).catch(error => {
          console.log('error', error)
        })
      }
    }
  });
</script>


{% endblock %}